---
title: [ClaudeCode] GitHubのsub-issueを簡単に管理するclaude code command /gh-sub-issue
tags: GH GitHub ClaudeCode
author: nakamasato
slide: false
---
## はじめに

GHのSub-issueは、タスク管理に置いて重要な機能ですが、直接 gh commandがないので、UI操作に頼りがちになってしまいます。

Issueの作成は、Claude CodeなどのCoding Agentにお願いすれば gh commandを使って簡単に作成できて便利です。使ってる方も多いのではないでしょうか。

一方で、sub-issueは、 gh apiを使えば操作可能ですが、Claude Codeなどでも自然言語でお願いしただけではうまく行かないケースがほとんどです。

今回は、 [REST API endpoints for sub-issues](https://docs.github.com/en/rest/issues/sub-issues?apiVersion=2022-11-28) こちらの公式Docを参照することが多いので、今回一度まとめておきたいと思います。

## Claude Codeでの活用

### Claude Code Slash Commands

gh sub-issueの操作は定型的なAPIコールなので、Claude Codeの[Slash Commands](https://code.claude.com/docs/en/slash-commands)として登録してみました。

SubagentsやSkillsも考えましたが、今回の内容はシンプルでコマンドのリストなので、 Claude Code Commandsを利用しました。

`.claude/commands/` ディレクトリにMarkdownファイルを配置することで、カスタムスラッシュコマンドとして利用できます。

プロジェクトルート(プロジェクトスコープ)またはPCのHOMEディレクトリ（ユーザースコープ）以下の構造でファイルを作成します：
````
.claude/
└── commands/
    └── gh-sub-issue.md
````

:::note info
私は、すべてのプロジェクトで使えるようにユーザースコープ (`~/.claude/commands/gh-sub-issue/md`)で定義しています。 
:::

### .claude/commands/gh-sub-issue.md

実際のSlash Commandの定義はこちらです。

````markdown:.claude/commands/gh-sub-issue.md
---
description: GitHub Sub-issue管理コマンド
---

# GitHub Sub-issue 操作

引数: $ARGUMENTS

以下のsub-issue操作を実行してください。

## 利用可能なコマンド

### sub-issueの一覧取得
```bash
gh api \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/{owner}/{repo}/issues/{issue_number}/sub_issues
```

### sub-issueの追加
```bash
gh api \
  --method POST \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/{owner}/{repo}/issues/{parent_issue_number}/sub_issues \
  -F "sub_issue_id={sub_issue_id}"
```

### sub-issueの削除
```bash
gh api \
  --method DELETE \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/{owner}/{repo}/issues/{parent_issue_number}/sub_issue \
  -F "sub_issue_id={sub_issue_id}"
```

### 親issueの取得
```bash
gh api \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/{owner}/{repo}/issues/{issue_number}/parent
```

## 注意事項
- `{owner}` と `{repo}` は現在のリポジトリから自動取得してください
- issue番号は `#123` 形式でも `123` でも受け付けてください
- sub_issue_id はissue番号ではなく、GitHub内部のIDです（APIレスポンスから取得）
````

### 使い方

Claude Codeで以下のようにスラッシュコマンドとして呼び出せます：
````
/sub-issue #42 のsub-issueを一覧表示して
/sub-issue #10 を #42 のsub-issueとして追加
/sub-issue #42 から #10 を削除
````

### 実際の使用例

Claude Code内で普通に依頼してもClaude Code Commandを使ってもらうことができました。

```
create gh sub-issue of #111 (このあとにsub issueにしたいissueの説明をかく)
```

![Screenshot 2025-12-08 at 11.33.05.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/7059/f89de0aa-bc8d-482c-a1fc-057be49efaf6.png)

この命令のあとに、gh issueを作成したあとに、上で定義したClaude Code commandが自動的に呼び出されているのがわかります。↓

![Screenshot 2025-12-08 at 11.32.47.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/7059/daae4c5b-584b-401a-8d49-39f1bbeb7601.png)

作成後に、sub-issueのリストも取得してみました。

![Screenshot 2025-12-08 at 12.14.37.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/7059/fef791d9-14b3-438e-85cf-246b3986a19d.png)

ちゃんと`/gh-sub-issue` が使われました。

## まとめ

Claude Code Commandsを準備してないとSub-issueの連携はできず、単純にリンクをIssueのBodyに書くだけになっていましたが、このCommandを書いておくだけで、Issue作成後にSub-issueへの追加などができるようになりました。

## Appendix: gh sub-issue 管理コマンド

### List sub issues:

```
gh api \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/OWNER/REPO/issues/ISSUE_NUMBER/sub_issues
```

### Remove sub-issue:

```
gh api \
  --method DELETE \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/OWNER/REPO/issues/ISSUE_NUMBER/sub_issue \
   -F "sub_issue_id=6"
```

### Add sub-issue:

```
gh api \
  --method POST \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/OWNER/REPO/issues/ISSUE_NUMBER/sub_issues \
   -F "sub_issue_id=1"
```

### Get parent issue

```
gh api \
  -H "Accept: application/vnd.github+json" \
  -H "X-GitHub-Api-Version: 2022-11-28" \
  /repos/OWNER/REPO/issues/ISSUE_NUMBER/parent
```


## Ref

- https://docs.github.com/en/rest/issues/sub-issues?apiVersion=2022-11-28
- slash commands: https://code.claude.com/docs/en/slash-commands
- agent skills: https://code.claude.com/docs/en/skills
- subagent: https://code.claude.com/docs/en/subagents

